setwd("D:/github/Courses/series")
x <- 1:10
M_t <- c(rep(0,5),rep(1,5))
plot(x,M_t)
x <- 1:10
m_t <- c(rep(0,5),rep(1,5))
plot(x,M_t, main = expression(S[t]^{(T)}))
#| fig-cap: 'Ilustración con $S_t^{(5)}$, d=1 y $\beta =0.5$.'
x <- 1:10
m_t <- c(rep(0,5-1),rep(1,5+1))
plot(x,m_t)
m_t <- 1 * (1-delta^(x))/(1-delta)
x <- 1:10
m_t <- 1 * (1-delta^(x-5))/(1-delta)
x <- 1:10
delta <- 0.5
m_t <- 1 * (1-delta^(x-5))/(1-delta)
m_t[1:5] <- 0
plot(x,m_t,ylab=expression(m[t]))
x <- 1:15
delta <- 0.5
m_t <- 1 * (1-delta^(x-5))/(1-delta)
m_t[1:5] <- 0
plot(x,m_t,ylab=expression(m[t]))
x-4
x
x-5
x-1-5
delta <- 0.5
m_t <- beta * delta^(x-1-5)
x <- 1:15
beta <- 1
delta <- 0.5
m_t <- beta * delta^(x-1-5)
m_t[1:5] <- 0
plot(x,m_t,ylab=expression(m[t]))
#| fig-cap: 'Ilustración con $T=5$, $\delta=0.5$ y $\beta=1$.'
#| label: 'fig-intervencion5'
x <- 1:15
beta <- 1
delta <- 0.5
m_t <- beta * delta^(x-1-5)
m_t[1:5] <- 0
plot(x,m_t,ylab=expression(m[t]))
library(TSA)
data("airmiles")
data(airmiles)
plot(airmiles)
air.m1=arimax(log(airmiles),order=c(0,1,1),
seasonal=list(order=c(0,1,1),period=12),
xtransf=data.frame(I911=1*(seq(airmiles)==69),
I911=1*(seq(airmiles)==69)),transfer=list(c(0,0),c(1,0)),
xreg=data.frame(Dec96=1*(seq(airmiles)==12),
Jan97=1*(seq(airmiles)==13),Dec02=1*(seq(airmiles)==84)),
method='ML')
air.m1
plot(log(airmiles),ylab='Log(airmiles)')
points(fitted(air.m1))
Nine11p=1*(seq(airmiles)==69)
plot(ts(Nine11p*(-0.0949)+
filter(Nine11p,filter=.8139,method='recursive', side=1)*
(-0.2715),frequency=12,start=1996),ylab='9/11 Effects',
type='h'); abline(h=0)
data(airmiles)
plot(airmiles)
data(airmiles)
plot(airmiles)
airmiles_pre <- window(log(airmiles),end=c(2001,8))
acf(as.vector(diff(diff(airmiles_pre),12)),lag.max=48)
acf2(as.vector(diff(diff(airmiles_pre),12)),lag.max=48)
#| echo: true
airmiles_pre <- window(log(airmiles),end=c(2001,8))
acf2(as.vector(diff(diff(airmiles_pre),12)),max.lag=48)
acf2(as.vector(diff(diff(airmiles_pre),12)),max.lag=48)
astsa::acf2(as.vector(diff(diff(airmiles_pre),12)),max.lag=48)
xreg <- data.frame(Dec96=1*(seq(airmiles)==12),
Jan97=1*(seq(airmiles)==13),Dec02=1*(seq(airmiles)==84))
xreg
xtransf <- data.frame(I911=1*(seq(airmiles)==69),
I911=1*(seq(airmiles)==69))
xreg <- data.frame(Dec96=1*(seq(airmiles)==12),
Jan97=1*(seq(airmiles)==13),Dec02=1*(seq(airmiles)==84))
air.m1=arimax(log(airmiles),order=c(0,1,1),
seasonal=list(order=c(0,1,1),period=12),
xtransf=xtransf,transfer=list(c(0,0),c(1,0)),
xreg=xreg,
method='ML')
summary(air.m1)
air.m1
Nine11p=1*(seq(airmiles)==69)
Nine11p
ts(Nine11p*(-0.0949)+
filter(Nine11p,filter=.8139,method='recursive', side=1)*
(-0.2715),frequency=12,start=1996)
filter(Nine11p,filter=.8139,method='recursive', side=1)
filter(Nine11p,filter=.8139,method='recursive', side=1)*
(-0.2715)
xtransf <- data.frame(I911=1*(seq(airmiles)==69),
I911=1*(seq(airmiles)==69))
xtransf
xtransf <- data.frame(I911=1*(seq(airmiles)==69), # efecto instantáneo - omega_0
I911=1*(seq(airmiles)==69)  # efecto AR(1) - omega_1
)
xtransf[65:69,]
xreg
#| echo: true
trend <- seq_along(austa)
#| echo: true
library(ggplot2)
library(forecast)
library(fpp2)
library(astsa)
library(sarima)
library(TSA)
#| echo: true
trend <- seq_along(austa)
(fit1 <- auto.arima(austa, d=0, xreg=trend))
#| echo: true
y <- uschange[,"Consumption"]
x <- uschange[,"Income"]
(mod <- auto.arima(y, xreg=x))
#| echo: true
y <- uschange[,"Consumption"]
x <- uschange[,"Income"]
mod0 <- Arima(y, xreg=x, order=c(1,1,0))
summary(mod0)
mod1 <- Arima(diff(y), xreg=diff(x), order=c(1,0,0)) #asume que tiene intercepto
summary(mod1)
sample(2:10,size=5)
sample(2:10,size=5)
sample(2:10,size=5)
